{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\Gorkem.Cadirci\\\\talep-sistemi\\\\src\\\\pages\\\\Inbox.js\",\n  _s = $RefreshSig$();\n// src/pages/Inbox.js\nimport React, { useEffect, useMemo, useState } from \"react\";\nimport { useNavigate, Link } from \"react-router-dom\";\nimport { DragDropContext, Droppable, Draggable } from \"@hello-pangea/dnd\";\nimport supabase from \"../supabaseClient\";\nimport \"./Inbox.css\";\n\n/** DB anahtar -> ekranda görünen */\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nconst STATUS_DISPLAY = {\n  Yeni: \"Yeni\",\n  Inceleme: \"İnceleme\",\n  Atandi: \"Atandı\",\n  Calisiliyor: \"Çalışılıyor\",\n  Beklemede: \"Beklemede\",\n  Tamamlandi: \"Tamamlandı\"\n};\nconst BOARD_COLUMNS = [{\n  key: \"Yeni\",\n  title: \"Yeni\"\n}, {\n  key: \"Inceleme\",\n  title: \"İnceleme\"\n}, {\n  key: \"Atandi\",\n  title: \"Atandı\"\n}, {\n  key: \"Calisiliyor\",\n  title: \"Çalışılıyor\"\n}, {\n  key: \"Beklemede\",\n  title: \"Beklemede\"\n}, {\n  key: \"Tamamlandi\",\n  title: \"Tamamlandı\"\n}];\nconst PILL_COLOR = {\n  P1: \"p1\",\n  P2: \"p2\",\n  P3: \"p3\"\n};\nexport default function InboxModern() {\n  _s();\n  const navigate = useNavigate();\n  const me = useMemo(() => {\n    try {\n      return JSON.parse(localStorage.getItem(\"user_profile\") || \"{}\");\n    } catch {\n      return {};\n    }\n  }, []);\n  const myEmail = (me === null || me === void 0 ? void 0 : me.email) || \"\";\n  const [view, setView] = useState(\"board\"); // \"board\" | \"list\"\n  const [q, setQ] = useState(\"\");\n  const [mineOnly, setMineOnly] = useState(false);\n  const [onlySLA, setOnlySLA] = useState(false);\n  const [loading, setLoading] = useState(false);\n  const [err, setErr] = useState(\"\");\n  const [rows, setRows] = useState([]);\n  const [active, setActive] = useState(null);\n  useEffect(() => {\n    const token = localStorage.getItem(\"auth_token\");\n    if (!token) navigate(\"/login\", {\n      replace: true\n    });\n  }, [navigate]);\n  useEffect(() => {\n    fetchData(); /* eslint-disable-next-line */\n  }, [mineOnly, onlySLA]);\n  async function fetchData() {\n    if (!myEmail) return;\n    setLoading(true);\n    setErr(\"\");\n    try {\n      const now = new Date();\n      let query = supabase.from(\"talepler\").select(`\n        id, baslik, durum, oncelik, talep_eden_email, atanan_email,\n        guncelleme_tarihi, bitis_tarihi, sla_son_tarih, aciklama,\n        kolon_sira, atanan_sira\n      `);\n\n      // Sıralama: mineOnly ise atanan_sira; değilse kolon_sira\n      if (mineOnly) {\n        query = query.eq(\"atanan_email\", myEmail).order(\"atanan_sira\", {\n          ascending: true,\n          nullsFirst: false\n        }).order(\"guncelleme_tarihi\", {\n          ascending: false\n        });\n      } else {\n        query = query.order(\"kolon_sira\", {\n          ascending: true,\n          nullsFirst: true\n        }).order(\"guncelleme_tarihi\", {\n          ascending: false\n        });\n      }\n      if (onlySLA) {\n        const t24 = new Date(now.getTime() + 24 * 60 * 60 * 1000).toISOString();\n        query = query.lt(\"sla_son_tarih\", t24).not(\"durum\", \"in\", [\"Tamamlandi\", \"Reddedildi\"]);\n      }\n      const {\n        data,\n        error\n      } = await query.limit(500);\n      if (error) throw error;\n      setRows(data || []);\n    } catch (e) {\n      console.error(e);\n      setErr(\"Kayıtlar çekilemedi.\");\n    } finally {\n      setLoading(false);\n    }\n  }\n\n  /* ---------- helpers ---------- */\n  function groupByStatus(items) {\n    const map = Object.fromEntries(BOARD_COLUMNS.map(c => [c.key, []]));\n    items.forEach(i => {\n      (map[i.durum || \"Yeni\"] ??= []).push(i);\n    });\n    return map;\n  }\n  function recomputeAssigneeRanks(list) {\n    const byA = {};\n    list.forEach(r => {\n      if (!r.atanan_email) return;\n      (byA[r.atanan_email] ??= []).push(r);\n    });\n    Object.values(byA).forEach(arr => {\n      arr.forEach((r, idx) => {\n        r.atanan_sira = idx + 1;\n      });\n    });\n  }\n  async function persistOrder(updates) {\n    // updates: [{id, durum?, kolon_sira?, atanan_sira?}]\n    if (!(updates !== null && updates !== void 0 && updates.length)) return;\n    const payload = updates.map(u => ({\n      id: u.id,\n      ...(u.durum !== undefined ? {\n        durum: u.durum\n      } : {}),\n      ...(u.kolon_sira !== undefined ? {\n        kolon_sira: u.kolon_sira\n      } : {}),\n      ...(u.atanan_sira !== undefined ? {\n        atanan_sira: u.atanan_sira\n      } : {}),\n      guncelleme_tarihi: new Date().toISOString()\n    }));\n    const {\n      error\n    } = await supabase.from(\"talepler\").upsert(payload, {\n      onConflict: \"id\"\n    });\n    if (error) console.error(\"order save error\", error);\n  }\n\n  /* ---------- DnD: Kanban ---------- */\n  async function onBoardDragEnd(result) {\n    const {\n      source,\n      destination,\n      draggableId\n    } = result;\n    if (!destination) return;\n    const statusFrom = source.droppableId;\n    const statusTo = destination.droppableId;\n    const byStatus = groupByStatus([...rows]);\n    const idx = byStatus[statusFrom].findIndex(i => String(i.id) === String(draggableId));\n    if (idx === -1) return;\n    const item = byStatus[statusFrom][idx];\n    byStatus[statusFrom].splice(idx, 1);\n    byStatus[statusTo].splice(destination.index, 0, item);\n    item.durum = statusTo;\n\n    // kolon sıraları\n    BOARD_COLUMNS.forEach(col => {\n      byStatus[col.key].forEach((it, i) => {\n        it.kolon_sira = i + 1;\n      });\n    });\n\n    // atanan sıraları\n    const flattened = BOARD_COLUMNS.flatMap(c => byStatus[c.key]);\n    recomputeAssigneeRanks(flattened);\n    setRows(flattened); // optimistic\n    await persistOrder(flattened.map(({\n      id,\n      durum,\n      kolon_sira,\n      atanan_sira\n    }) => ({\n      id,\n      durum,\n      kolon_sira,\n      atanan_sira\n    })));\n  }\n\n  /* ---------- DnD: Liste (Bana atananlar) ---------- */\n  async function onListDragEnd(result) {\n    const {\n      source,\n      destination,\n      draggableId\n    } = result;\n    if (!destination) return;\n    if (!mineOnly) return; // sadece \"Bana atananlar\" açıkken\n\n    const list = filtered.filter(r => r.atanan_email === myEmail);\n    const from = list.findIndex(i => String(i.id) === String(draggableId));\n    if (from === -1) return;\n    const moved = list[from];\n    list.splice(from, 1);\n    list.splice(destination.index, 0, moved);\n    list.forEach((r, i) => {\n      r.atanan_sira = i + 1;\n    });\n    const newRows = rows.map(r => {\n      const hit = list.find(x => x.id === r.id);\n      return hit ? {\n        ...r,\n        atanan_sira: hit.atanan_sira\n      } : r;\n    });\n    setRows(newRows); // optimistic\n\n    await persistOrder(list.map(({\n      id,\n      atanan_sira\n    }) => ({\n      id,\n      atanan_sira\n    })));\n  }\n\n  /* ---------- only action left: Üstlen ---------- */\n  async function takeOwnership(id) {\n    if (!myEmail) return;\n    const myColMax = rows.filter(r => r.durum === \"Inceleme\").reduce((m, r) => Math.max(m, r.kolon_sira || 0), 0) + 1;\n    const myQueueMax = rows.filter(r => r.atanan_email === myEmail).reduce((m, r) => Math.max(m, r.atanan_sira || 0), 0) + 1;\n    const {\n      error\n    } = await supabase.from(\"talepler\").update({\n      atanan_email: myEmail,\n      durum: \"Inceleme\",\n      kolon_sira: myColMax,\n      atanan_sira: myQueueMax,\n      guncelleme_tarihi: new Date().toISOString()\n    }).eq(\"id\", id);\n    if (!error) fetchData();\n  }\n  function handleLogout() {\n    localStorage.removeItem(\"auth_token\");\n    localStorage.removeItem(\"user_profile\");\n    navigate(\"/login\", {\n      replace: true\n    });\n  }\n\n  /* ---------- filter ---------- */\n  const filtered = rows.filter(r => {\n    if (!q) return true;\n    const text = `${r.id} ${r.baslik} ${r.talep_eden_email} ${r.atanan_email || \"\"}`.toLowerCase();\n    return text.includes(q.toLowerCase());\n  });\n  const grouped = groupByStatus(filtered);\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: \"mx\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mx-top\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"brand\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"logo\",\n          children: \"\\uD83E\\uDDED\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 217,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"bt\",\n          children: [/*#__PURE__*/_jsxDEV(\"h1\", {\n            children: \"Gelen Kutusu\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 219,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: \"muted\",\n            children: \"\\u0130\\u015F & S\\xFCre\\xE7 Geli\\u015Ftirme\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 220,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 218,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"cmd\",\n        children: [/*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"seg\",\n          children: [/*#__PURE__*/_jsxDEV(\"button\", {\n            className: `seg-btn ${view === \"board\" ? \"on\" : \"\"}`,\n            onClick: () => setView(\"board\"),\n            children: \"Kanban\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 226,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            className: `seg-btn ${view === \"list\" ? \"on\" : \"\"}`,\n            onClick: () => setView(\"list\"),\n            children: \"Liste\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 227,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 225,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"search-wrap\",\n          children: /*#__PURE__*/_jsxDEV(\"input\", {\n            className: \"search\",\n            placeholder: \"Ara: #id, ba\\u015Fl\\u0131k, ki\\u015Fi\\u2026\",\n            value: q,\n            onChange: e => setQ(e.target.value)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 231,\n            columnNumber: 25\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 230,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"toggles\",\n          children: [/*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"toggle\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"checkbox\",\n              checked: mineOnly,\n              onChange: e => setMineOnly(e.target.checked)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 236,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"Bana atananlar\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 237,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 235,\n            columnNumber: 25\n          }, this), /*#__PURE__*/_jsxDEV(\"label\", {\n            className: \"toggle\",\n            children: [/*#__PURE__*/_jsxDEV(\"input\", {\n              type: \"checkbox\",\n              checked: onlySLA,\n              onChange: e => setOnlySLA(e.target.checked)\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 240,\n              columnNumber: 29\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \"SLA (<24s)\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 241,\n              columnNumber: 29\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 239,\n            columnNumber: 25\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 234,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(Link, {\n          to: \"/newrequest\",\n          className: \"btn primary\",\n          children: \"+ Yeni Talep\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 245,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"chip\",\n          children: (me === null || me === void 0 ? void 0 : me.kullanici) || (me === null || me === void 0 ? void 0 : me.email)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 246,\n          columnNumber: 21\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn danger\",\n          onClick: handleLogout,\n          children: \"\\xC7\\u0131k\\u0131\\u015F\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 247,\n          columnNumber: 21\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 215,\n      columnNumber: 13\n    }, this), err && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mx-alert err\",\n      children: err\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 21\n    }, this), loading ? /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mx-skel\",\n      children: \"Y\\xFCkleniyor\\u2026\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 254,\n      columnNumber: 17\n    }, this) : view === \"board\" ? /*#__PURE__*/_jsxDEV(DragDropContext, {\n      onDragEnd: onBoardDragEnd,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"board\",\n        children: BOARD_COLUMNS.map(col => {\n          const items = grouped[col.key] || [];\n          return /*#__PURE__*/_jsxDEV(Droppable, {\n            droppableId: col.key,\n            children: provided => /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"col\",\n              ref: provided.innerRef,\n              ...provided.droppableProps,\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-head\",\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: `dot s-${slug(col.title)}`\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 265,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"h3\", {\n                  children: col.title\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 266,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"count\",\n                  children: items.length\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 267,\n                  columnNumber: 49\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 264,\n                columnNumber: 45\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                className: \"col-body\",\n                children: [items.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n                  className: \"col-empty\",\n                  children: \"Hen\\xFCz kay\\u0131t yok\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 270,\n                  columnNumber: 72\n                }, this), items.map((item, index) => /*#__PURE__*/_jsxDEV(Draggable, {\n                  draggableId: String(item.id),\n                  index: index,\n                  children: pp => /*#__PURE__*/_jsxDEV(\"div\", {\n                    ref: pp.innerRef,\n                    ...pp.draggableProps,\n                    ...pp.dragHandleProps,\n                    children: /*#__PURE__*/_jsxDEV(Card, {\n                      data: item,\n                      onOpen: () => setActive(item),\n                      onTake: () => takeOwnership(item.id),\n                      me: myEmail\n                    }, void 0, false, {\n                      fileName: _jsxFileName,\n                      lineNumber: 275,\n                      columnNumber: 65\n                    }, this)\n                  }, void 0, false, {\n                    fileName: _jsxFileName,\n                    lineNumber: 274,\n                    columnNumber: 61\n                  }, this)\n                }, item.id, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 272,\n                  columnNumber: 53\n                }, this)), provided.placeholder]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 269,\n                columnNumber: 45\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 263,\n              columnNumber: 41\n            }, this)\n          }, col.key, false, {\n            fileName: _jsxFileName,\n            lineNumber: 261,\n            columnNumber: 33\n          }, this);\n        })\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 257,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 256,\n      columnNumber: 17\n    }, this) :\n    /*#__PURE__*/\n    // LISTE GÖRÜNÜMÜ — mineOnly açıkken sürükleyerek atanan_sira değiştir\n    _jsxDEV(DragDropContext, {\n      onDragEnd: onListDragEnd,\n      children: /*#__PURE__*/_jsxDEV(Droppable, {\n        droppableId: \"listMine\",\n        isDropDisabled: !mineOnly,\n        children: provided => /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"listv\",\n          ref: provided.innerRef,\n          ...provided.droppableProps,\n          children: [filtered.length === 0 && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"col-empty\",\n            children: \"Kay\\u0131t bulunamad\\u0131\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 300,\n            columnNumber: 59\n          }, this), filtered.map((r, index) => /*#__PURE__*/_jsxDEV(Draggable, {\n            draggableId: String(r.id),\n            index: index,\n            isDragDisabled: !mineOnly,\n            children: pp => {\n              var _r$atanan_sira;\n              return /*#__PURE__*/_jsxDEV(\"div\", {\n                ref: pp.innerRef,\n                ...pp.draggableProps,\n                ...pp.dragHandleProps,\n                className: \"rowv\",\n                onClick: () => setActive(r),\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  className: `pill ${PILL_COLOR[r.oncelik] || \"p3\"}`,\n                  children: r.oncelik || \"P3\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 308,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: `badge s-${slug(STATUS_DISPLAY[r.durum] || \"Yeni\")}`,\n                  children: STATUS_DISPLAY[r.durum] || \"Yeni\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 309,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"r-title\",\n                  children: [\"#\", r.id, \" \\u2014 \", r.baslik]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 310,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"r-sub\",\n                  children: [r.talep_eden_email, \" \\u2192 \", r.atanan_email || \"—\", mineOnly && r.atanan_email === myEmail && /*#__PURE__*/_jsxDEV(\"b\", {\n                    style: {\n                      marginLeft: 8,\n                      opacity: .8\n                    },\n                    children: [\"(S\\u0131ra: \", (_r$atanan_sira = r.atanan_sira) !== null && _r$atanan_sira !== void 0 ? _r$atanan_sira : \"—\", \")\"]\n                  }, void 0, true, {\n                    fileName: _jsxFileName,\n                    lineNumber: 314,\n                    columnNumber: 57\n                  }, this)]\n                }, void 0, true, {\n                  fileName: _jsxFileName,\n                  lineNumber: 311,\n                  columnNumber: 49\n                }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n                  className: \"r-time\",\n                  children: fmtTime(r.guncelleme_tarihi)\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 317,\n                  columnNumber: 49\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 304,\n                columnNumber: 45\n              }, this);\n            }\n          }, r.id, false, {\n            fileName: _jsxFileName,\n            lineNumber: 302,\n            columnNumber: 37\n          }, this)), provided.placeholder, !mineOnly && /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"hint\",\n            style: {\n              padding: 8,\n              opacity: .7\n            },\n            children: \"Listeyi s\\xFCr\\xFCkleyerek s\\u0131ralamak i\\xE7in \\u201CBana atananlar\\u201D\\u0131 i\\u015Faretleyin.\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 324,\n            columnNumber: 37\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 299,\n          columnNumber: 29\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 297,\n        columnNumber: 21\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 296,\n      columnNumber: 17\n    }, this), active && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"drawer\",\n      role: \"dialog\",\n      \"aria-modal\": \"true\",\n      children: [/*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"drawer-panel\",\n        children: [/*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"drawer-close\",\n          onClick: () => setActive(null),\n          children: \"\\xD7\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 338,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"drawer-top\",\n          children: [/*#__PURE__*/_jsxDEV(\"span\", {\n            className: `pill ${PILL_COLOR[active.oncelik] || \"p3\"}`,\n            children: active.oncelik || \"P3\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 341,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n            className: `badge s-${slug(STATUS_DISPLAY[active.durum] || \"Yeni\")}`,\n            children: STATUS_DISPLAY[active.durum] || \"Yeni\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 342,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"h2\", {\n            children: [\"#\", active.id, \" \\u2014 \", active.baslik]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 343,\n            columnNumber: 29\n          }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n            className: \"d-sub\",\n            children: [/*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\"\\u0130steyen: \", /*#__PURE__*/_jsxDEV(\"b\", {\n                children: active.talep_eden_email\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 345,\n                columnNumber: 48\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 345,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \" \\xB7 \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 346,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\"Atanan: \", /*#__PURE__*/_jsxDEV(\"b\", {\n                children: active.atanan_email || \"—\"\n              }, void 0, false, {\n                fileName: _jsxFileName,\n                lineNumber: 347,\n                columnNumber: 47\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 347,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: \" \\xB7 \"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 348,\n              columnNumber: 33\n            }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n              children: [\"G\\xFCncellendi: \", fmtTime(active.guncelleme_tarihi)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 349,\n              columnNumber: 33\n            }, this)]\n          }, void 0, true, {\n            fileName: _jsxFileName,\n            lineNumber: 344,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 340,\n          columnNumber: 25\n        }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n          className: \"drawer-body\",\n          children: [/*#__PURE__*/_jsxDEV(Section, {\n            title: \"A\\xE7\\u0131klama\",\n            children: /*#__PURE__*/_jsxDEV(\"p\", {\n              className: \"desc\",\n              children: active.aciklama || \"Açıklama girilmemiş.\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 355,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 354,\n            columnNumber: 29\n          }, this), !active.atanan_email && /*#__PURE__*/_jsxDEV(Section, {\n            title: \"Atama\",\n            children: /*#__PURE__*/_jsxDEV(\"button\", {\n              className: \"btn primary\",\n              onClick: () => {\n                setActive(null);\n                takeOwnership(active.id);\n              },\n              children: \"\\xDCstlen\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 361,\n              columnNumber: 37\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 360,\n            columnNumber: 33\n          }, this), /*#__PURE__*/_jsxDEV(Section, {\n            title: \"Zaman\",\n            children: /*#__PURE__*/_jsxDEV(\"div\", {\n              className: \"kv\",\n              children: [/*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"Hedef Tarih:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 369,\n                  columnNumber: 42\n                }, this), /*#__PURE__*/_jsxDEV(\"b\", {\n                  children: active.bitis_tarihi ? fmtDate(active.bitis_tarihi) : \"—\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 369,\n                  columnNumber: 67\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 369,\n                columnNumber: 37\n              }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n                children: [/*#__PURE__*/_jsxDEV(\"span\", {\n                  children: \"SLA Son:\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 370,\n                  columnNumber: 42\n                }, this), /*#__PURE__*/_jsxDEV(\"b\", {\n                  children: active.sla_son_tarih ? fmtDate(active.sla_son_tarih) : \"—\"\n                }, void 0, false, {\n                  fileName: _jsxFileName,\n                  lineNumber: 370,\n                  columnNumber: 63\n                }, this)]\n              }, void 0, true, {\n                fileName: _jsxFileName,\n                lineNumber: 370,\n                columnNumber: 37\n              }, this)]\n            }, void 0, true, {\n              fileName: _jsxFileName,\n              lineNumber: 368,\n              columnNumber: 33\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 367,\n            columnNumber: 29\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 353,\n          columnNumber: 25\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 337,\n        columnNumber: 21\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"drawer-backdrop\",\n        onClick: () => setActive(null)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 375,\n        columnNumber: 21\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 336,\n      columnNumber: 17\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 213,\n    columnNumber: 9\n  }, this);\n}\n\n/* components */\n_s(InboxModern, \"DUig31uHprqalMRXFYUZUHTraJg=\", false, function () {\n  return [useNavigate];\n});\n_c = InboxModern;\nfunction Card({\n  data,\n  onOpen,\n  onTake,\n  me\n}) {\n  const mine = data.atanan_email && data.atanan_email === me;\n  const slaSoon = data.sla_son_tarih && new Date(data.sla_son_tarih).getTime() - Date.now() < 24 * 60 * 60 * 1000;\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    className: `card ${mine ? \"mine\" : \"\"}`,\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"c-top\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: `pill ${PILL_COLOR[data.oncelik] || \"p3\"}`,\n        children: data.oncelik || \"P3\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 390,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        className: `badge s-${slug(STATUS_DISPLAY[data.durum] || \"Yeni\")}`,\n        children: STATUS_DISPLAY[data.durum] || \"Yeni\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 391,\n        columnNumber: 17\n      }, this), slaSoon && /*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"sla\",\n        children: \"SLA\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 392,\n        columnNumber: 29\n      }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n        className: \"icn\",\n        onClick: onOpen,\n        title: \"Detay\",\n        children: \"\\u22EF\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 393,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 389,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"c-title\",\n      children: [\"#\", data.id, \" \\u2014 \", data.baslik]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 396,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"c-sub\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        children: data.talep_eden_email\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 398,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: \"\\u2192\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 399,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"span\", {\n        children: data.atanan_email || \"—\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 400,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 397,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"c-foot\",\n      children: [/*#__PURE__*/_jsxDEV(\"span\", {\n        className: \"time\",\n        children: fmtTime(data.guncelleme_tarihi)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 404,\n        columnNumber: 17\n      }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"act\",\n        children: !data.atanan_email && /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn ghost xs\",\n          onClick: onTake,\n          children: \"\\xDCstlen\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 406,\n          columnNumber: 44\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 405,\n        columnNumber: 17\n      }, this)]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 403,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 388,\n    columnNumber: 9\n  }, this);\n}\n_c2 = Card;\nfunction Section({\n  title,\n  children\n}) {\n  return /*#__PURE__*/_jsxDEV(\"section\", {\n    className: \"sec\",\n    children: [/*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"sec-h\",\n      children: /*#__PURE__*/_jsxDEV(\"h4\", {\n        children: title\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 417,\n        columnNumber: 36\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 417,\n      columnNumber: 13\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"sec-b\",\n      children: children\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 418,\n      columnNumber: 13\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 416,\n    columnNumber: 9\n  }, this);\n}\n\n/* utils */\n_c3 = Section;\nfunction slug(s) {\n  return (s || \"\").toLowerCase().replaceAll(\"ı\", \"i\").replaceAll(\"ğ\", \"g\").replaceAll(\"ş\", \"s\").replaceAll(\"ö\", \"o\").replaceAll(\"ç\", \"c\").replaceAll(\"ü\", \"u\").replace(/\\s+/g, \"-\");\n}\nfunction fmtTime(ts) {\n  try {\n    return new Date(ts).toLocaleString();\n  } catch {\n    return \"—\";\n  }\n}\nfunction fmtDate(ts) {\n  try {\n    return new Date(ts).toLocaleDateString();\n  } catch {\n    return \"—\";\n  }\n}\nvar _c, _c2, _c3;\n$RefreshReg$(_c, \"InboxModern\");\n$RefreshReg$(_c2, \"Card\");\n$RefreshReg$(_c3, \"Section\");","map":{"version":3,"names":["React","useEffect","useMemo","useState","useNavigate","Link","DragDropContext","Droppable","Draggable","supabase","jsxDEV","_jsxDEV","STATUS_DISPLAY","Yeni","Inceleme","Atandi","Calisiliyor","Beklemede","Tamamlandi","BOARD_COLUMNS","key","title","PILL_COLOR","P1","P2","P3","InboxModern","_s","navigate","me","JSON","parse","localStorage","getItem","myEmail","email","view","setView","q","setQ","mineOnly","setMineOnly","onlySLA","setOnlySLA","loading","setLoading","err","setErr","rows","setRows","active","setActive","token","replace","fetchData","now","Date","query","from","select","eq","order","ascending","nullsFirst","t24","getTime","toISOString","lt","not","data","error","limit","e","console","groupByStatus","items","map","Object","fromEntries","c","forEach","i","durum","push","recomputeAssigneeRanks","list","byA","r","atanan_email","values","arr","idx","atanan_sira","persistOrder","updates","length","payload","u","id","undefined","kolon_sira","guncelleme_tarihi","upsert","onConflict","onBoardDragEnd","result","source","destination","draggableId","statusFrom","droppableId","statusTo","byStatus","findIndex","String","item","splice","index","col","it","flattened","flatMap","onListDragEnd","filtered","filter","moved","newRows","hit","find","x","takeOwnership","myColMax","reduce","m","Math","max","myQueueMax","update","handleLogout","removeItem","text","baslik","talep_eden_email","toLowerCase","includes","grouped","className","children","fileName","_jsxFileName","lineNumber","columnNumber","onClick","placeholder","value","onChange","target","type","checked","to","kullanici","onDragEnd","provided","ref","innerRef","droppableProps","slug","pp","draggableProps","dragHandleProps","Card","onOpen","onTake","isDropDisabled","isDragDisabled","_r$atanan_sira","oncelik","style","marginLeft","opacity","fmtTime","padding","role","Section","aciklama","bitis_tarihi","fmtDate","sla_son_tarih","_c","mine","slaSoon","_c2","_c3","s","replaceAll","ts","toLocaleString","toLocaleDateString","$RefreshReg$"],"sources":["C:/Users/Gorkem.Cadirci/talep-sistemi/src/pages/Inbox.js"],"sourcesContent":["// src/pages/Inbox.js\r\nimport React, { useEffect, useMemo, useState } from \"react\";\r\nimport { useNavigate, Link } from \"react-router-dom\";\r\nimport { DragDropContext, Droppable, Draggable } from \"@hello-pangea/dnd\";\r\nimport supabase from \"../supabaseClient\";\r\nimport \"./Inbox.css\";\r\n\r\n/** DB anahtar -> ekranda görünen */\r\nconst STATUS_DISPLAY = {\r\n    Yeni: \"Yeni\",\r\n    Inceleme: \"İnceleme\",\r\n    Atandi: \"Atandı\",\r\n    Calisiliyor: \"Çalışılıyor\",\r\n    Beklemede: \"Beklemede\",\r\n    Tamamlandi: \"Tamamlandı\",\r\n};\r\n\r\nconst BOARD_COLUMNS = [\r\n    { key: \"Yeni\", title: \"Yeni\" },\r\n    { key: \"Inceleme\", title: \"İnceleme\" },\r\n    { key: \"Atandi\", title: \"Atandı\" },\r\n    { key: \"Calisiliyor\", title: \"Çalışılıyor\" },\r\n    { key: \"Beklemede\", title: \"Beklemede\" },\r\n    { key: \"Tamamlandi\", title: \"Tamamlandı\" },\r\n];\r\n\r\nconst PILL_COLOR = { P1: \"p1\", P2: \"p2\", P3: \"p3\" };\r\n\r\nexport default function InboxModern() {\r\n    const navigate = useNavigate();\r\n\r\n    const me = useMemo(() => {\r\n        try { return JSON.parse(localStorage.getItem(\"user_profile\") || \"{}\"); }\r\n        catch { return {}; }\r\n    }, []);\r\n    const myEmail = me?.email || \"\";\r\n\r\n    const [view, setView] = useState(\"board\"); // \"board\" | \"list\"\r\n    const [q, setQ] = useState(\"\");\r\n    const [mineOnly, setMineOnly] = useState(false);\r\n    const [onlySLA, setOnlySLA] = useState(false);\r\n    const [loading, setLoading] = useState(false);\r\n    const [err, setErr] = useState(\"\");\r\n    const [rows, setRows] = useState([]);\r\n    const [active, setActive] = useState(null);\r\n\r\n    useEffect(() => {\r\n        const token = localStorage.getItem(\"auth_token\");\r\n        if (!token) navigate(\"/login\", { replace: true });\r\n    }, [navigate]);\r\n\r\n    useEffect(() => { fetchData(); /* eslint-disable-next-line */ }, [mineOnly, onlySLA]);\r\n\r\n    async function fetchData() {\r\n        if (!myEmail) return;\r\n        setLoading(true); setErr(\"\");\r\n        try {\r\n            const now = new Date();\r\n\r\n            let query = supabase.from(\"talepler\").select(`\r\n        id, baslik, durum, oncelik, talep_eden_email, atanan_email,\r\n        guncelleme_tarihi, bitis_tarihi, sla_son_tarih, aciklama,\r\n        kolon_sira, atanan_sira\r\n      `);\r\n\r\n            // Sıralama: mineOnly ise atanan_sira; değilse kolon_sira\r\n            if (mineOnly) {\r\n                query = query.eq(\"atanan_email\", myEmail)\r\n                    .order(\"atanan_sira\", { ascending: true, nullsFirst: false })\r\n                    .order(\"guncelleme_tarihi\", { ascending: false });\r\n            } else {\r\n                query = query.order(\"kolon_sira\", { ascending: true, nullsFirst: true })\r\n                    .order(\"guncelleme_tarihi\", { ascending: false });\r\n            }\r\n\r\n            if (onlySLA) {\r\n                const t24 = new Date(now.getTime() + 24 * 60 * 60 * 1000).toISOString();\r\n                query = query.lt(\"sla_son_tarih\", t24).not(\"durum\", \"in\", [\"Tamamlandi\", \"Reddedildi\"]);\r\n            }\r\n\r\n            const { data, error } = await query.limit(500);\r\n            if (error) throw error;\r\n            setRows(data || []);\r\n        } catch (e) {\r\n            console.error(e);\r\n            setErr(\"Kayıtlar çekilemedi.\");\r\n        } finally {\r\n            setLoading(false);\r\n        }\r\n    }\r\n\r\n    /* ---------- helpers ---------- */\r\n    function groupByStatus(items) {\r\n        const map = Object.fromEntries(BOARD_COLUMNS.map(c => [c.key, []]));\r\n        items.forEach(i => { (map[i.durum || \"Yeni\"] ??= []).push(i); });\r\n        return map;\r\n    }\r\n\r\n    function recomputeAssigneeRanks(list) {\r\n        const byA = {};\r\n        list.forEach(r => {\r\n            if (!r.atanan_email) return;\r\n            (byA[r.atanan_email] ??= []).push(r);\r\n        });\r\n        Object.values(byA).forEach(arr => {\r\n            arr.forEach((r, idx) => { r.atanan_sira = idx + 1; });\r\n        });\r\n    }\r\n\r\n    async function persistOrder(updates) {\r\n        // updates: [{id, durum?, kolon_sira?, atanan_sira?}]\r\n        if (!updates?.length) return;\r\n        const payload = updates.map(u => ({\r\n            id: u.id,\r\n            ...(u.durum !== undefined ? { durum: u.durum } : {}),\r\n            ...(u.kolon_sira !== undefined ? { kolon_sira: u.kolon_sira } : {}),\r\n            ...(u.atanan_sira !== undefined ? { atanan_sira: u.atanan_sira } : {}),\r\n            guncelleme_tarihi: new Date().toISOString(),\r\n        }));\r\n        const { error } = await supabase.from(\"talepler\").upsert(payload, { onConflict: \"id\" });\r\n        if (error) console.error(\"order save error\", error);\r\n    }\r\n\r\n    /* ---------- DnD: Kanban ---------- */\r\n    async function onBoardDragEnd(result) {\r\n        const { source, destination, draggableId } = result;\r\n        if (!destination) return;\r\n\r\n        const statusFrom = source.droppableId;\r\n        const statusTo = destination.droppableId;\r\n\r\n        const byStatus = groupByStatus([...rows]);\r\n        const idx = byStatus[statusFrom].findIndex(i => String(i.id) === String(draggableId));\r\n        if (idx === -1) return;\r\n\r\n        const item = byStatus[statusFrom][idx];\r\n        byStatus[statusFrom].splice(idx, 1);\r\n        byStatus[statusTo].splice(destination.index, 0, item);\r\n        item.durum = statusTo;\r\n\r\n        // kolon sıraları\r\n        BOARD_COLUMNS.forEach(col => {\r\n            byStatus[col.key].forEach((it, i) => { it.kolon_sira = i + 1; });\r\n        });\r\n\r\n        // atanan sıraları\r\n        const flattened = BOARD_COLUMNS.flatMap(c => byStatus[c.key]);\r\n        recomputeAssigneeRanks(flattened);\r\n\r\n        setRows(flattened); // optimistic\r\n        await persistOrder(flattened.map(({ id, durum, kolon_sira, atanan_sira }) => ({ id, durum, kolon_sira, atanan_sira })));\r\n    }\r\n\r\n    /* ---------- DnD: Liste (Bana atananlar) ---------- */\r\n    async function onListDragEnd(result) {\r\n        const { source, destination, draggableId } = result;\r\n        if (!destination) return;\r\n        if (!mineOnly) return; // sadece \"Bana atananlar\" açıkken\r\n\r\n        const list = filtered.filter(r => r.atanan_email === myEmail);\r\n        const from = list.findIndex(i => String(i.id) === String(draggableId));\r\n        if (from === -1) return;\r\n\r\n        const moved = list[from];\r\n        list.splice(from, 1);\r\n        list.splice(destination.index, 0, moved);\r\n\r\n        list.forEach((r, i) => { r.atanan_sira = i + 1; });\r\n\r\n        const newRows = rows.map(r => {\r\n            const hit = list.find(x => x.id === r.id);\r\n            return hit ? { ...r, atanan_sira: hit.atanan_sira } : r;\r\n        });\r\n        setRows(newRows); // optimistic\r\n\r\n        await persistOrder(list.map(({ id, atanan_sira }) => ({ id, atanan_sira })));\r\n    }\r\n\r\n    /* ---------- only action left: Üstlen ---------- */\r\n    async function takeOwnership(id) {\r\n        if (!myEmail) return;\r\n        const myColMax = rows.filter(r => r.durum === \"Inceleme\")\r\n            .reduce((m, r) => Math.max(m, r.kolon_sira || 0), 0) + 1;\r\n        const myQueueMax = rows.filter(r => r.atanan_email === myEmail)\r\n            .reduce((m, r) => Math.max(m, r.atanan_sira || 0), 0) + 1;\r\n\r\n        const { error } = await supabase.from(\"talepler\").update({\r\n            atanan_email: myEmail,\r\n            durum: \"Inceleme\",\r\n            kolon_sira: myColMax,\r\n            atanan_sira: myQueueMax,\r\n            guncelleme_tarihi: new Date().toISOString()\r\n        }).eq(\"id\", id);\r\n        if (!error) fetchData();\r\n    }\r\n\r\n    function handleLogout() {\r\n        localStorage.removeItem(\"auth_token\");\r\n        localStorage.removeItem(\"user_profile\");\r\n        navigate(\"/login\", { replace: true });\r\n    }\r\n\r\n    /* ---------- filter ---------- */\r\n    const filtered = rows.filter(r => {\r\n        if (!q) return true;\r\n        const text = `${r.id} ${r.baslik} ${r.talep_eden_email} ${r.atanan_email || \"\"}`.toLowerCase();\r\n        return text.includes(q.toLowerCase());\r\n    });\r\n\r\n    const grouped = groupByStatus(filtered);\r\n\r\n    return (\r\n        <div className=\"mx\">\r\n            {/* Command bar */}\r\n            <div className=\"mx-top\">\r\n                <div className=\"brand\">\r\n                    <div className=\"logo\">🧭</div>\r\n                    <div className=\"bt\">\r\n                        <h1>Gelen Kutusu</h1>\r\n                        <span className=\"muted\">İş & Süreç Geliştirme</span>\r\n                    </div>\r\n                </div>\r\n\r\n                <div className=\"cmd\">\r\n                    <div className=\"seg\">\r\n                        <button className={`seg-btn ${view === \"board\" ? \"on\" : \"\"}`} onClick={() => setView(\"board\")}>Kanban</button>\r\n                        <button className={`seg-btn ${view === \"list\" ? \"on\" : \"\"}`} onClick={() => setView(\"list\")}>Liste</button>\r\n                    </div>\r\n\r\n                    <div className=\"search-wrap\">\r\n                        <input className=\"search\" placeholder=\"Ara: #id, başlık, kişi…\" value={q} onChange={(e) => setQ(e.target.value)} />\r\n                    </div>\r\n\r\n                    <div className=\"toggles\">\r\n                        <label className=\"toggle\">\r\n                            <input type=\"checkbox\" checked={mineOnly} onChange={e => setMineOnly(e.target.checked)} />\r\n                            <span>Bana atananlar</span>\r\n                        </label>\r\n                        <label className=\"toggle\">\r\n                            <input type=\"checkbox\" checked={onlySLA} onChange={e => setOnlySLA(e.target.checked)} />\r\n                            <span>SLA (&lt;24s)</span>\r\n                        </label>\r\n                    </div>\r\n\r\n                    <Link to=\"/newrequest\" className=\"btn primary\">+ Yeni Talep</Link>\r\n                    <div className=\"chip\">{me?.kullanici || me?.email}</div>\r\n                    <button className=\"btn danger\" onClick={handleLogout}>Çıkış</button>\r\n                </div>\r\n            </div>\r\n\r\n            {err && <div className=\"mx-alert err\">{err}</div>}\r\n\r\n            {loading ? (\r\n                <div className=\"mx-skel\">Yükleniyor…</div>\r\n            ) : view === \"board\" ? (\r\n                <DragDropContext onDragEnd={onBoardDragEnd}>\r\n                    <div className=\"board\">\r\n                        {BOARD_COLUMNS.map(col => {\r\n                            const items = grouped[col.key] || [];\r\n                            return (\r\n                                <Droppable droppableId={col.key} key={col.key}>\r\n                                    {(provided) => (\r\n                                        <div className=\"col\" ref={provided.innerRef} {...provided.droppableProps}>\r\n                                            <div className=\"col-head\">\r\n                                                <span className={`dot s-${slug(col.title)}`}></span>\r\n                                                <h3>{col.title}</h3>\r\n                                                <span className=\"count\">{items.length}</span>\r\n                                            </div>\r\n                                            <div className=\"col-body\">\r\n                                                {items.length === 0 && <div className=\"col-empty\">Henüz kayıt yok</div>}\r\n                                                {items.map((item, index) => (\r\n                                                    <Draggable draggableId={String(item.id)} index={index} key={item.id}>\r\n                                                        {(pp) => (\r\n                                                            <div ref={pp.innerRef} {...pp.draggableProps} {...pp.dragHandleProps}>\r\n                                                                <Card\r\n                                                                    data={item}\r\n                                                                    onOpen={() => setActive(item)}\r\n                                                                    onTake={() => takeOwnership(item.id)}\r\n                                                                    me={myEmail}\r\n                                                                />\r\n                                                            </div>\r\n                                                        )}\r\n                                                    </Draggable>\r\n                                                ))}\r\n                                                {provided.placeholder}\r\n                                            </div>\r\n                                        </div>\r\n                                    )}\r\n                                </Droppable>\r\n                            );\r\n                        })}\r\n                    </div>\r\n                </DragDropContext>\r\n            ) : (\r\n                // LISTE GÖRÜNÜMÜ — mineOnly açıkken sürükleyerek atanan_sira değiştir\r\n                <DragDropContext onDragEnd={onListDragEnd}>\r\n                    <Droppable droppableId=\"listMine\" isDropDisabled={!mineOnly}>\r\n                        {(provided) => (\r\n                            <div className=\"listv\" ref={provided.innerRef} {...provided.droppableProps}>\r\n                                {filtered.length === 0 && <div className=\"col-empty\">Kayıt bulunamadı</div>}\r\n                                {filtered.map((r, index) => (\r\n                                    <Draggable draggableId={String(r.id)} index={index} key={r.id} isDragDisabled={!mineOnly}>\r\n                                        {(pp) => (\r\n                                            <div\r\n                                                ref={pp.innerRef} {...pp.draggableProps} {...pp.dragHandleProps}\r\n                                                className=\"rowv\" onClick={() => setActive(r)}\r\n                                            >\r\n                                                <span className={`pill ${PILL_COLOR[r.oncelik] || \"p3\"}`}>{r.oncelik || \"P3\"}</span>\r\n                                                <span className={`badge s-${slug(STATUS_DISPLAY[r.durum] || \"Yeni\")}`}>{STATUS_DISPLAY[r.durum] || \"Yeni\"}</span>\r\n                                                <span className=\"r-title\">#{r.id} — {r.baslik}</span>\r\n                                                <span className=\"r-sub\">\r\n                                                    {r.talep_eden_email} → {r.atanan_email || \"—\"}\r\n                                                    {mineOnly && r.atanan_email === myEmail && (\r\n                                                        <b style={{ marginLeft: 8, opacity: .8 }}>(Sıra: {r.atanan_sira ?? \"—\"})</b>\r\n                                                    )}\r\n                                                </span>\r\n                                                <span className=\"r-time\">{fmtTime(r.guncelleme_tarihi)}</span>\r\n                                            </div>\r\n                                        )}\r\n                                    </Draggable>\r\n                                ))}\r\n                                {provided.placeholder}\r\n                                {!mineOnly && (\r\n                                    <div className=\"hint\" style={{ padding: 8, opacity: .7 }}>\r\n                                        Listeyi sürükleyerek sıralamak için “Bana atananlar”ı işaretleyin.\r\n                                    </div>\r\n                                )}\r\n                            </div>\r\n                        )}\r\n                    </Droppable>\r\n                </DragDropContext>\r\n            )}\r\n\r\n            {/* Detay çekmecesi */}\r\n            {active && (\r\n                <div className=\"drawer\" role=\"dialog\" aria-modal=\"true\">\r\n                    <div className=\"drawer-panel\">\r\n                        <button className=\"drawer-close\" onClick={() => setActive(null)}>×</button>\r\n\r\n                        <div className=\"drawer-top\">\r\n                            <span className={`pill ${PILL_COLOR[active.oncelik] || \"p3\"}`}>{active.oncelik || \"P3\"}</span>\r\n                            <span className={`badge s-${slug(STATUS_DISPLAY[active.durum] || \"Yeni\")}`}>{STATUS_DISPLAY[active.durum] || \"Yeni\"}</span>\r\n                            <h2>#{active.id} — {active.baslik}</h2>\r\n                            <div className=\"d-sub\">\r\n                                <span>İsteyen: <b>{active.talep_eden_email}</b></span>\r\n                                <span> · </span>\r\n                                <span>Atanan: <b>{active.atanan_email || \"—\"}</b></span>\r\n                                <span> · </span>\r\n                                <span>Güncellendi: {fmtTime(active.guncelleme_tarihi)}</span>\r\n                            </div>\r\n                        </div>\r\n\r\n                        <div className=\"drawer-body\">\r\n                            <Section title=\"Açıklama\">\r\n                                <p className=\"desc\">{active.aciklama || \"Açıklama girilmemiş.\"}</p>\r\n                            </Section>\r\n\r\n                            {/* Sadece Üstlen (atanmamışsa) */}\r\n                            {!active.atanan_email && (\r\n                                <Section title=\"Atama\">\r\n                                    <button className=\"btn primary\" onClick={() => { setActive(null); takeOwnership(active.id); }}>\r\n                                        Üstlen\r\n                                    </button>\r\n                                </Section>\r\n                            )}\r\n\r\n                            <Section title=\"Zaman\">\r\n                                <div className=\"kv\">\r\n                                    <div><span>Hedef Tarih:</span><b>{active.bitis_tarihi ? fmtDate(active.bitis_tarihi) : \"—\"}</b></div>\r\n                                    <div><span>SLA Son:</span><b>{active.sla_son_tarih ? fmtDate(active.sla_son_tarih) : \"—\"}</b></div>\r\n                                </div>\r\n                            </Section>\r\n                        </div>\r\n                    </div>\r\n                    <div className=\"drawer-backdrop\" onClick={() => setActive(null)} />\r\n                </div>\r\n            )}\r\n        </div>\r\n    );\r\n}\r\n\r\n/* components */\r\nfunction Card({ data, onOpen, onTake, me }) {\r\n    const mine = data.atanan_email && data.atanan_email === me;\r\n    const slaSoon = data.sla_son_tarih && new Date(data.sla_son_tarih).getTime() - Date.now() < 24 * 60 * 60 * 1000;\r\n\r\n    return (\r\n        <div className={`card ${mine ? \"mine\" : \"\"}`}>\r\n            <div className=\"c-top\">\r\n                <span className={`pill ${PILL_COLOR[data.oncelik] || \"p3\"}`}>{data.oncelik || \"P3\"}</span>\r\n                <span className={`badge s-${slug(STATUS_DISPLAY[data.durum] || \"Yeni\")}`}>{STATUS_DISPLAY[data.durum] || \"Yeni\"}</span>\r\n                {slaSoon && <span className=\"sla\">SLA</span>}\r\n                <button className=\"icn\" onClick={onOpen} title=\"Detay\">⋯</button>\r\n            </div>\r\n\r\n            <div className=\"c-title\">#{data.id} — {data.baslik}</div>\r\n            <div className=\"c-sub\">\r\n                <span>{data.talep_eden_email}</span>\r\n                <span>→</span>\r\n                <span>{data.atanan_email || \"—\"}</span>\r\n            </div>\r\n\r\n            <div className=\"c-foot\">\r\n                <span className=\"time\">{fmtTime(data.guncelleme_tarihi)}</span>\r\n                <div className=\"act\">\r\n                    {!data.atanan_email && <button className=\"btn ghost xs\" onClick={onTake}>Üstlen</button>}\r\n                    {/* Diğer durum butonları kaldırıldı; sürükle-bırak ile yönetiliyor */}\r\n                </div>\r\n            </div>\r\n        </div>\r\n    );\r\n}\r\n\r\nfunction Section({ title, children }) {\r\n    return (\r\n        <section className=\"sec\">\r\n            <div className=\"sec-h\"><h4>{title}</h4></div>\r\n            <div className=\"sec-b\">{children}</div>\r\n        </section>\r\n    );\r\n}\r\n\r\n/* utils */\r\nfunction slug(s) { return (s || \"\").toLowerCase().replaceAll(\"ı\", \"i\").replaceAll(\"ğ\", \"g\").replaceAll(\"ş\", \"s\").replaceAll(\"ö\", \"o\").replaceAll(\"ç\", \"c\").replaceAll(\"ü\", \"u\").replace(/\\s+/g, \"-\"); }\r\nfunction fmtTime(ts) { try { return new Date(ts).toLocaleString(); } catch { return \"—\"; } }\r\nfunction fmtDate(ts) { try { return new Date(ts).toLocaleDateString(); } catch { return \"—\"; } }\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}